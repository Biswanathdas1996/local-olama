# Source Citation Feature - Quick Reference Guide

## ğŸ¯ What's New

Every AI response now includes **mandatory source citations**:

### For RAG Responses (with document search):
```
âœ… Document name
âœ… Page number (if available)
âœ… Relevance score
âœ… Model attribution
```

### For Non-RAG Responses (direct AI):
```
âœ… Model name
âœ… Verification disclaimer
```

---

## ğŸ“Š Citation Format

### RAG Response Example
```markdown
The quantum entanglement phenomenon occurs when...

---
**Sources:**

1. Quantum_Physics_Textbook, Page 42 (relevance: 95%)
2. Advanced_Quantum_Mechanics, Page 17 (relevance: 87%)

*Response generated by AI model: llama3.2:1b*
```

### Non-RAG Response Example
```markdown
Quantum computing is based on quantum mechanics...

---
*Note: This response was generated by the AI model 'llama3.2:1b'. 
Please verify important information from authoritative sources.*
```

---

## ğŸ¨ UI Display

### Source Citation Box (Assistant Messages)
- Gray background boxes for each source
- Teal/cyan highlights for page numbers
- Small text for relevance scores
- Italic text for model attribution

---

## ğŸ”§ How It Works

### Backend Flow
```
1. User Query
2. RAG Search (if indices selected)
3. Extract: page numbers, relevance scores, text excerpts
4. Generate Response with LLM
5. Append Citations to Response
6. Return: response + sources array
```

### Frontend Flow
```
1. Receive Response + Sources
2. Display Response Text (with markdown)
3. Render Source Citations Box
4. Show Page Numbers & Relevance
```

---

## ğŸ“„ Page Number Support

| Document Type | Page Number Field | Example |
|--------------|-------------------|---------|
| PDF          | `page`            | Page 42 |
| DOCX         | `page`            | Page 15 |
| PowerPoint   | `slide`           | Slide 7 |
| HTML         | N/A               | No page |
| TXT          | N/A               | No page |

---

## âœ… Benefits

1. ğŸ” **Transparency**: Know exactly where info comes from
2. ğŸ“– **Traceability**: Easy verification with page numbers
3. ğŸ¯ **Trust**: Clear source attribution
4. âš–ï¸ **Compliance**: Meets citation requirements
5. ğŸ‘¥ **UX**: Clean, professional presentation
